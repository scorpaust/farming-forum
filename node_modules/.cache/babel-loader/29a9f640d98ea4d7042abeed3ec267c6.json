{"remainingRequest":"C:\\dev\\farming-forum\\node_modules\\babel-loader\\lib\\index.js!C:\\dev\\farming-forum\\node_modules\\eslint-loader\\index.js??ref--14-0!C:\\dev\\farming-forum\\src\\store\\modules\\auth.js","dependencies":[{"path":"C:\\dev\\farming-forum\\src\\store\\modules\\auth.js","mtime":1640859575852},{"path":"C:\\dev\\farming-forum\\babel.config.js","mtime":1638558199793},{"path":"C:\\dev\\farming-forum\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\dev\\farming-forum\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\dev\\farming-forum\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkM6XFxkZXZcXGZhcm1pbmctZm9ydW1cXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lXFxoZWxwZXJzXFxlc21cXGFzeW5jVG9HZW5lcmF0b3IuanMiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiZmlyZWJhc2Uvc3RvcmFnZSI7CmltcG9ydCB7IEdvb2dsZUF1dGhQcm92aWRlciwgY3JlYXRlVXNlcldpdGhFbWFpbEFuZFBhc3N3b3JkLCBnZXRBdXRoLCBzaWduSW5XaXRoRW1haWxBbmRQYXNzd29yZCBhcyBfc2lnbkluV2l0aEVtYWlsQW5kUGFzc3dvcmQsIHNpZ25JbldpdGhQb3B1cCB9IGZyb20gImZpcmViYXNlL2F1dGgiOwppbXBvcnQgeyBjb2xsZWN0aW9uLCBkb2MsIGdldERvYywgZ2V0RG9jcywgbGltaXQsIG9yZGVyQnksIHF1ZXJ5LCBzdGFydEFmdGVyLCB3aGVyZSB9IGZyb20gImZpcmViYXNlL2ZpcmVzdG9yZSI7CmltcG9ydCB7IGRiLCBzdG9yYWdlIH0gZnJvbSAiLi4vLi4vbWFpbiI7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lc3BhY2VkOiB0cnVlLAogIHN0YXRlOiB7CiAgICBhdXRoSWQ6IG51bGwsCiAgICBhdXRoVXNlclVuc3Vic2NyaWJlOiBudWxsLAogICAgYXV0aE9ic2VydmVyVW5zdWJzY3JpYmU6IG51bGwKICB9LAogIGdldHRlcnM6IHsKICAgIGF1dGhVc2VyOiBmdW5jdGlvbiBhdXRoVXNlcihzdGF0ZSwgZ2V0dGVycywgcm9vdFN0YXRlLCByb290R2V0dGVycykgewogICAgICByZXR1cm4gcm9vdEdldHRlcnNbJ3VzZXJzL3VzZXInXShzdGF0ZS5hdXRoSWQpOwogICAgfQogIH0sCiAgYWN0aW9uczogewogICAgaW5pdEF1dGhlbnRpY2F0aW9uOiBmdW5jdGlvbiBpbml0QXV0aGVudGljYXRpb24oX3JlZikgewogICAgICB2YXIgc3RhdGUgPSBfcmVmLnN0YXRlLAogICAgICAgICAgZGlzcGF0Y2ggPSBfcmVmLmRpc3BhdGNoLAogICAgICAgICAgY29tbWl0ID0gX3JlZi5jb21taXQ7CiAgICAgIGlmIChzdGF0ZS5hdXRoT2JzZXJ2ZXJVbnN1YnNjcmliZSkgc3RhdGUuYXV0aE9ic2VydmVyVW5zdWJzY3JpYmUoKTsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICB2YXIgdW5zdWJzY3JpYmUgPSBnZXRBdXRoKCkub25BdXRoU3RhdGVDaGFuZ2VkKCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIF9yZWYyID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKHVzZXIpIHsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoKCd1bnN1YnNjcmliZUF1dGhVc2VyU25hcHNob3QnKTsKCiAgICAgICAgICAgICAgICAgICAgaWYgKCF1c2VyKSB7CiAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNzsKICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRpc3BhdGNoKCdmZXRjaEF1dGhVc2VyJyk7CgogICAgICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICAgICAgcmVzKHVzZXIpOwogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA4OwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgICAgIHJlcyhudWxsKTsKCiAgICAgICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgICAgICB9KSk7CgogICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChfeCkgewogICAgICAgICAgICByZXR1cm4gX3JlZjIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgIH07CiAgICAgICAgfSgpKTsKICAgICAgICBjb21taXQoInNldEF1dGhPYnNlcnZlclVuc3Vic2NyaWJlIiwgdW5zdWJzY3JpYmUpOwogICAgICB9KTsKICAgIH0sCiAgICByZWdpc3RlclVzZXJXaXRoRW1haWxBbmRQYXNzd29yZDogZnVuY3Rpb24gcmVnaXN0ZXJVc2VyV2l0aEVtYWlsQW5kUGFzc3dvcmQoX3JlZjMsIF9yZWY0KSB7CiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgICAgIHZhciBkaXNwYXRjaCwgX3JlZjQkYXZhdGFyLCBhdmF0YXIsIGVtYWlsLCBuYW1lLCB1c2VybmFtZSwgcGFzc3dvcmQsIGF1dGgsIHJlc3VsdCwgc2IsIHNuYXBzaG90OwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgZGlzcGF0Y2ggPSBfcmVmMy5kaXNwYXRjaDsKICAgICAgICAgICAgICAgIF9yZWY0JGF2YXRhciA9IF9yZWY0LmF2YXRhciwgYXZhdGFyID0gX3JlZjQkYXZhdGFyID09PSB2b2lkIDAgPyBudWxsIDogX3JlZjQkYXZhdGFyLCBlbWFpbCA9IF9yZWY0LmVtYWlsLCBuYW1lID0gX3JlZjQubmFtZSwgdXNlcm5hbWUgPSBfcmVmNC51c2VybmFtZSwgcGFzc3dvcmQgPSBfcmVmNC5wYXNzd29yZDsKICAgICAgICAgICAgICAgIGF1dGggPSBnZXRBdXRoKCk7CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDU7CiAgICAgICAgICAgICAgICByZXR1cm4gY3JlYXRlVXNlcldpdGhFbWFpbEFuZFBhc3N3b3JkKGF1dGgsIGVtYWlsLCBwYXNzd29yZCk7CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0Mi5zZW50OwoKICAgICAgICAgICAgICAgIGlmICghYXZhdGFyKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTQ7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHNiID0gc3RvcmFnZS5yZWYoKS5jaGlsZCgidXBsb2Fkcy8iLmNvbmNhdChyZXN1bHQudXNlci51aWQsICIvaW1hZ2VzLyIpLmNvbmNhdChEYXRlLm5vdygpLCAiLSIpLmNvbmNhdChhdmF0YXIubmFtZSkpOwogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxMDsKICAgICAgICAgICAgICAgIHJldHVybiBzYi5wdXQoYXZhdGFyKTsKCiAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICAgIHNuYXBzaG90ID0gX2NvbnRleHQyLnNlbnQ7CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDEzOwogICAgICAgICAgICAgICAgcmV0dXJuIHNuYXBzaG90LnJlZi5nZXREb3dubG9hZFVSTCgpOwoKICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgICAgYXZhdGFyID0gX2NvbnRleHQyLnNlbnQ7CgogICAgICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDE2OwogICAgICAgICAgICAgICAgcmV0dXJuIGRpc3BhdGNoKCd1c2Vycy9jcmVhdGVVc2VyJywgewogICAgICAgICAgICAgICAgICBpZDogcmVzdWx0LnVzZXIudWlkLAogICAgICAgICAgICAgICAgICBlbWFpbDogZW1haWwsCiAgICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUsCiAgICAgICAgICAgICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZSwKICAgICAgICAgICAgICAgICAgYXZhdGFyOiBhdmF0YXIKICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgcm9vdDogdHJ1ZQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMTY6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTIpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBzaWduSW5XaXRoRW1haWxBbmRQYXNzd29yZDogZnVuY3Rpb24gc2lnbkluV2l0aEVtYWlsQW5kUGFzc3dvcmQoY29udGV4dCwgX3JlZjUpIHsKICAgICAgdmFyIGVtYWlsID0gX3JlZjUuZW1haWwsCiAgICAgICAgICBwYXNzd29yZCA9IF9yZWY1LnBhc3N3b3JkOwogICAgICB2YXIgYXV0aCA9IGdldEF1dGgoKTsKICAgICAgcmV0dXJuIF9zaWduSW5XaXRoRW1haWxBbmRQYXNzd29yZChhdXRoLCBlbWFpbCwgcGFzc3dvcmQpOwogICAgfSwKICAgIHNpZ25JbldpdGhHb29nbGU6IGZ1bmN0aW9uIHNpZ25JbldpdGhHb29nbGUoX3JlZjYpIHsKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoKSB7CiAgICAgICAgdmFyIGRpc3BhdGNoLCBjb21taXQsIHByb3ZpZGVyLCBhdXRoLCByZXNwb25zZSwgdXNlciwgdXNlclJlZjsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0MykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgZGlzcGF0Y2ggPSBfcmVmNi5kaXNwYXRjaCwgY29tbWl0ID0gX3JlZjYuY29tbWl0OwogICAgICAgICAgICAgICAgcHJvdmlkZXIgPSBuZXcgR29vZ2xlQXV0aFByb3ZpZGVyKCk7CiAgICAgICAgICAgICAgICBhdXRoID0gZ2V0QXV0aCgpOwogICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA1OwogICAgICAgICAgICAgICAgcmV0dXJuIHNpZ25JbldpdGhQb3B1cChhdXRoLCBwcm92aWRlcik7CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gX2NvbnRleHQzLnNlbnQ7CiAgICAgICAgICAgICAgICB1c2VyID0gcmVzcG9uc2UudXNlcjsKICAgICAgICAgICAgICAgIHVzZXJSZWYgPSBkb2MoZGIsICd1c2VycycsIHVzZXIudWlkKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMTA7CiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0RG9jKHVzZXJSZWYpLnRoZW4oZnVuY3Rpb24gKHVzZXJEb2MpIHsKICAgICAgICAgICAgICAgICAgaWYgKCF1c2VyRG9jLmV4aXN0cykgcmV0dXJuIGRpc3BhdGNoKCd1c2Vycy9jcmVhdGVVc2VyJywgewogICAgICAgICAgICAgICAgICAgIGlkOiB1c2VyLnVpZCwKICAgICAgICAgICAgICAgICAgICBlbWFpbDogdXNlci5lbWFpbCwKICAgICAgICAgICAgICAgICAgICBuYW1lOiB1c2VyLmRpc3BsYXlOYW1lLAogICAgICAgICAgICAgICAgICAgIHVzZXJuYW1lOiB1c2VyLmVtYWlsLAogICAgICAgICAgICAgICAgICAgIGF2YXRhcjogdXNlci5waG90b1VSTAogICAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgICAgcm9vdDogdHJ1ZQogICAgICAgICAgICAgICAgICB9KTtlbHNlIGNvbW1pdCgnc2V0QXV0aElkJywgdXNlci51aWQpOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTMpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBzaWduT3V0OiBmdW5jdGlvbiBzaWduT3V0KF9yZWY3KSB7CiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KCkgewogICAgICAgIHZhciBjb21taXQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0JChfY29udGV4dDQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ0LnByZXYgPSBfY29udGV4dDQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGNvbW1pdCA9IF9yZWY3LmNvbW1pdDsKICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMzsKICAgICAgICAgICAgICAgIHJldHVybiBnZXRBdXRoKCkuc2lnbk91dCgpOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICBjb21taXQoJ3NldEF1dGhJZCcsIG51bGwpOwoKICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTQpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBmZXRjaEF1dGhVc2VyOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfZmV0Y2hBdXRoVXNlciA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTUoX3JlZjgpIHsKICAgICAgICB2YXIgX2dldEF1dGgkY3VycmVudFVzZXI7CgogICAgICAgIHZhciBkaXNwYXRjaCwgc3RhdGUsIGNvbW1pdCwgdXNlcklkOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNSQoX2NvbnRleHQ1KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBkaXNwYXRjaCA9IF9yZWY4LmRpc3BhdGNoLCBzdGF0ZSA9IF9yZWY4LnN0YXRlLCBjb21taXQgPSBfcmVmOC5jb21taXQ7CiAgICAgICAgICAgICAgICB1c2VySWQgPSAoX2dldEF1dGgkY3VycmVudFVzZXIgPSBnZXRBdXRoKCkuY3VycmVudFVzZXIpID09PSBudWxsIHx8IF9nZXRBdXRoJGN1cnJlbnRVc2VyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZ2V0QXV0aCRjdXJyZW50VXNlci51aWQ7CgogICAgICAgICAgICAgICAgaWYgKHVzZXJJZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSA2OwogICAgICAgICAgICAgICAgcmV0dXJuIGRpc3BhdGNoKCdmZXRjaEl0ZW0nLCB7CiAgICAgICAgICAgICAgICAgIGVtb2ppOiAn8J+ZiycsCiAgICAgICAgICAgICAgICAgIHJlc291cmNlOiAndXNlcnMnLAogICAgICAgICAgICAgICAgICBpZDogdXNlcklkLAogICAgICAgICAgICAgICAgICBoYW5kbGVVbnN1YnNjcmliZTogZnVuY3Rpb24gaGFuZGxlVW5zdWJzY3JpYmUodW5zdWJzY3JpYmUpIHsKICAgICAgICAgICAgICAgICAgICBjb21taXQoJ3NldEF1dGhVc2VyVW5zdWJzY3JpYmUnLCB1bnN1YnNjcmliZSk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgcm9vdDogdHJ1ZQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICAgIGNvbW1pdCgnc2V0QXV0aElkJywgdXNlcklkKTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU1KTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gZmV0Y2hBdXRoVXNlcihfeDIpIHsKICAgICAgICByZXR1cm4gX2ZldGNoQXV0aFVzZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGZldGNoQXV0aFVzZXI7CiAgICB9KCksCiAgICBmZXRjaEF1dGhVc2Vyc1Bvc3RzOiBmdW5jdGlvbiBmZXRjaEF1dGhVc2Vyc1Bvc3RzKF9yZWY5LCBfcmVmMTApIHsKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTYoKSB7CiAgICAgICAgdmFyIGNvbW1pdCwgc3RhdGUsIGxhc3RQb3N0LCBwb3N0c1JlZiwgcG9zdHNRdWVyeSwgcG9zdHMsIG5leHQsIF9wb3N0cywgX3Bvc3RzMjsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU2JChfY29udGV4dDYpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ2LnByZXYgPSBfY29udGV4dDYubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGNvbW1pdCA9IF9yZWY5LmNvbW1pdCwgc3RhdGUgPSBfcmVmOS5zdGF0ZTsKICAgICAgICAgICAgICAgIGxhc3RQb3N0ID0gX3JlZjEwLmxhc3RQb3N0OwogICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSA0OwogICAgICAgICAgICAgICAgcmV0dXJuIGNvbGxlY3Rpb24oZGIsICJwb3N0cyIpOwoKICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICBwb3N0c1JlZiA9IF9jb250ZXh0Ni5zZW50OwogICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSA3OwogICAgICAgICAgICAgICAgcmV0dXJuIGdldERvY3MocXVlcnkocG9zdHNSZWYsIHdoZXJlKCJ1c2VySWQiLCAiPT0iLCBzdGF0ZS5hdXRoSWQpLCBvcmRlckJ5KCJwdWJsaXNoZWRBdCIsICJkZXNjIiksIGxpbWl0KDEwKSkpOwoKICAgICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgICBwb3N0c1F1ZXJ5ID0gX2NvbnRleHQ2LnNlbnQ7CiAgICAgICAgICAgICAgICBwb3N0cyA9IFtdOwoKICAgICAgICAgICAgICAgIGlmICghbGFzdFBvc3QpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSAxNzsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgbmV4dCA9IHF1ZXJ5KHBvc3RzUXVlcnkucXVlcnksIHN0YXJ0QWZ0ZXIobGFzdFBvc3QpKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMTM7CiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0RG9jcyhuZXh0KTsKCiAgICAgICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgICAgIF9wb3N0cyA9IF9jb250ZXh0Ni5zZW50OwoKICAgICAgICAgICAgICAgIF9wb3N0cy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgICAgICAgIGNvbW1pdCgnc2V0SXRlbScsIHsKICAgICAgICAgICAgICAgICAgICByZXNvdXJjZTogJ3Bvc3RzJywKICAgICAgICAgICAgICAgICAgICBpdGVtOiBpdGVtCiAgICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgICByb290OiB0cnVlCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSAxOTsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgICAgICAgX3Bvc3RzMiA9IHBvc3RzUXVlcnk7CgogICAgICAgICAgICAgICAgX3Bvc3RzMi5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgICAgICAgIGNvbW1pdCgnc2V0SXRlbScsIHsKICAgICAgICAgICAgICAgICAgICByZXNvdXJjZTogJ3Bvc3RzJywKICAgICAgICAgICAgICAgICAgICBpdGVtOiBpdGVtCiAgICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgICByb290OiB0cnVlCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMTk6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTYpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICB1bnN1YnNjcmliZUF1dGhVc2VyU25hcHNob3Q6IGZ1bmN0aW9uIHVuc3Vic2NyaWJlQXV0aFVzZXJTbmFwc2hvdChfcmVmMTEpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU3KCkgewogICAgICAgIHZhciBzdGF0ZSwgY29tbWl0OwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNyQoX2NvbnRleHQ3KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Ny5wcmV2ID0gX2NvbnRleHQ3Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBzdGF0ZSA9IF9yZWYxMS5zdGF0ZSwgY29tbWl0ID0gX3JlZjExLmNvbW1pdDsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuc3RhdGUuYXV0aFVzZXJVbnN1YnNjcmliZSkgewogICAgICAgICAgICAgICAgICBfdGhpcy5zdGF0ZS5hdXRoVXNlclVuc3Vic2NyaWJlKCk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgY29tbWl0KCdzZXRBdXRoVXNlclVuc3Vic2NyaWJlJywgbnVsbCk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNyk7CiAgICAgIH0pKSgpOwogICAgfQogIH0sCiAgbXV0YXRpb25zOiB7CiAgICBzZXRBdXRoSWQ6IGZ1bmN0aW9uIHNldEF1dGhJZChzdGF0ZSwgaWQpIHsKICAgICAgc3RhdGUuYXV0aElkID0gaWQ7CiAgICB9LAogICAgc2V0QXV0aFVzZXJVbnN1YnNjcmliZTogZnVuY3Rpb24gc2V0QXV0aFVzZXJVbnN1YnNjcmliZShzdGF0ZSwgdW5zdWJzY3JpYmUpIHsKICAgICAgc3RhdGUuYXV0aFVzZXJVbnN1YnNjcmliZSA9IHVuc3Vic2NyaWJlOwogICAgfSwKICAgIHNldEF1dGhPYnNlcnZlclVuc3Vic2NyaWJlOiBmdW5jdGlvbiBzZXRBdXRoT2JzZXJ2ZXJVbnN1YnNjcmliZShzdGF0ZSwgdW5zdWJzY3JpYmUpIHsKICAgICAgc3RhdGUuYXV0aE9ic2VydmVyVW5zdWJzY3JpYmUgPSB1bnN1YnNjcmliZTsKICAgIH0KICB9Cn07"},{"version":3,"sources":["C:/dev/farming-forum/src/store/modules/auth.js"],"names":["GoogleAuthProvider","createUserWithEmailAndPassword","getAuth","signInWithEmailAndPassword","signInWithPopup","collection","doc","getDoc","getDocs","limit","orderBy","query","startAfter","where","db","storage","namespaced","state","authId","authUserUnsubscribe","authObserverUnsubscribe","getters","authUser","rootState","rootGetters","actions","initAuthentication","dispatch","commit","Promise","res","unsubscribe","onAuthStateChanged","user","registerUserWithEmailAndPassword","avatar","email","name","username","password","auth","result","sb","ref","child","uid","Date","now","put","snapshot","getDownloadURL","id","root","context","signInWithGoogle","provider","response","userRef","then","userDoc","exists","displayName","photoURL","signOut","fetchAuthUser","userId","currentUser","emoji","resource","handleUnsubscribe","fetchAuthUsersPosts","lastPost","postsRef","postsQuery","posts","next","forEach","item","unsubscribeAuthUserSnapshot","mutations","setAuthId","setAuthUserUnsubscribe","setAuthObserverUnsubscribe"],"mappings":"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","sourcesContent":["import \"firebase/storage\";\r\n\r\nimport { GoogleAuthProvider, createUserWithEmailAndPassword, getAuth, signInWithEmailAndPassword, signInWithPopup } from \"firebase/auth\"\r\nimport { collection, doc, getDoc, getDocs, limit, orderBy, query, startAfter, where } from \"firebase/firestore\"\r\nimport { db, storage } from \"../../main\"\r\n\r\nexport default {\r\n  namespaced: true,\r\n  state: {\r\n    authId: null,\r\n    authUserUnsubscribe: null,\r\n    authObserverUnsubscribe: null\r\n  },\r\n  getters: {\r\n    authUser: (state, getters, rootState, rootGetters) => {\r\n      return rootGetters['users/user'](state.authId)\r\n    },\r\n  },\r\n  actions: {\r\n    initAuthentication({state, dispatch, commit}) {\r\n      if (state.authObserverUnsubscribe) state.authObserverUnsubscribe()\r\n      return new Promise((res) => {\r\n        const unsubscribe = getAuth().onAuthStateChanged(async (user) => {\r\n          dispatch('unsubscribeAuthUserSnapshot')\r\n          if (user) {\r\n            await dispatch('fetchAuthUser')\r\n            res(user)\r\n          } else {\r\n            res(null)\r\n          }\r\n        })\r\n        commit(\"setAuthObserverUnsubscribe\", unsubscribe)\r\n      })\r\n    },\r\n\r\n    async registerUserWithEmailAndPassword({ dispatch }, {avatar = null, email, name, username, password }) {\r\n      const auth = getAuth();\r\n      const result = await createUserWithEmailAndPassword(\r\n        auth,\r\n        email,\r\n        password\r\n      )\r\n      if (avatar) {\r\n        const sb = storage.ref().child(`uploads/${result.user.uid}/images/${Date.now()}-${avatar.name}`)\r\n        const snapshot = await sb.put(avatar)\r\n        avatar = await snapshot.ref.getDownloadURL()\r\n      }\r\n      await dispatch('users/createUser', { id: result.user.uid, email, name, username, avatar }, {root: true} )\r\n    },\r\n    signInWithEmailAndPassword(context, {email, password}) {\r\n      const auth = getAuth()\r\n      return signInWithEmailAndPassword(auth, email, password)\r\n    },\r\n    async signInWithGoogle({dispatch, commit}) {\r\n      const provider = new GoogleAuthProvider();\r\n      const auth = getAuth();\r\n      const response = await signInWithPopup(auth, provider)\r\n      const user = response.user;\r\n      const userRef = doc(db, 'users', user.uid)\r\n      await getDoc(userRef).then((userDoc) => {\r\n        if (!userDoc.exists)\r\n          return dispatch('users/createUser', {id: user.uid, email: user.email, name: user.displayName, username: user.email, avatar: user.photoURL}, {root: true} )\r\n        else \r\n          commit('setAuthId', user.uid)\r\n      })\r\n    },\r\n    async signOut({commit}) {\r\n      await getAuth().signOut()\r\n      commit('setAuthId', null)\r\n    },\r\n\r\n    fetchAuthUser: async ({ dispatch, state, commit }) => {\r\n      const userId = getAuth().currentUser?.uid\r\n      if (!userId) return\r\n      await dispatch('fetchItem', { emoji:'🙋', resource: 'users', id: userId, handleUnsubscribe: (unsubscribe) => {\r\n        commit('setAuthUserUnsubscribe', unsubscribe)\r\n      }}, {root: true} )\r\n      commit('setAuthId', userId)\r\n    },\r\n    async fetchAuthUsersPosts ({ commit, state }, {lastPost}) {\r\n      const postsRef = await collection(db, \"posts\")\r\n      let postsQuery = await getDocs(query(postsRef, where(\"userId\", \"==\", state.authId), orderBy(\"publishedAt\", \"desc\"), limit(10)))\r\n      const posts = []\r\n      if (lastPost) {\r\n        const next = query(postsQuery.query, startAfter(lastPost))\r\n        const posts = await getDocs(next)\r\n        posts.forEach(item => {\r\n        commit('setItem', { resource: 'posts', item }, {root: true})\r\n        })\r\n      } else {\r\n        const posts = postsQuery\r\n        posts.forEach(item => {\r\n          commit('setItem', { resource: 'posts', item }, {root: true})\r\n          })\r\n      }\r\n    },\r\n    async unsubscribeAuthUserSnapshot ({ state, commit }) {\r\n      if (this.state.authUserUnsubscribe) {       \r\n        this.state.authUserUnsubscribe()\r\n      }\r\n      commit('setAuthUserUnsubscribe', null) \r\n    }\r\n  },\r\n  mutations: {\r\n    setAuthId(state, id) {\r\n      state.authId = id\r\n    },\r\n    setAuthUserUnsubscribe (state, unsubscribe) {\r\n      state.authUserUnsubscribe = unsubscribe\r\n    },\r\n    setAuthObserverUnsubscribe (state, unsubscribe) {\r\n      state.authObserverUnsubscribe = unsubscribe\r\n    },\r\n  }\r\n}"]}]}