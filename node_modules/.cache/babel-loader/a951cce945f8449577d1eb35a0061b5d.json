{"remainingRequest":"C:\\dev\\farming-forum\\node_modules\\babel-loader\\lib\\index.js!C:\\dev\\farming-forum\\node_modules\\eslint-loader\\index.js??ref--14-0!C:\\dev\\farming-forum\\src\\store\\modules\\users.js","dependencies":[{"path":"C:\\dev\\farming-forum\\src\\store\\modules\\users.js","mtime":1639938572707},{"path":"C:\\dev\\farming-forum\\babel.config.js","mtime":1638558199793},{"path":"C:\\dev\\farming-forum\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\dev\\farming-forum\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\dev\\farming-forum\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkM6XFxkZXZcXGZhcm1pbmctZm9ydW1cXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lXFxoZWxwZXJzXFxlc21cXGFzeW5jVG9HZW5lcmF0b3IuanMiOwppbXBvcnQgX29iamVjdFNwcmVhZCBmcm9tICJDOlxcZGV2XFxmYXJtaW5nLWZvcnVtXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZVxcaGVscGVyc1xcZXNtXFxvYmplY3RTcHJlYWQyLmpzIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCB7IGRvYywgZ2V0RG9jLCBzZXJ2ZXJUaW1lc3RhbXAsIHNldERvYywgdXBkYXRlRG9jIH0gZnJvbSAnZmlyZWJhc2UvZmlyZXN0b3JlJzsKaW1wb3J0IHsgZG9jVG9SZXNvdXJjZSwgZmluZEJ5SWQsIG1ha2VBcHBlbmRDaGlsZFRvUGFyZW50TXV0YXRpb24gfSBmcm9tICdAL2hlbHBlcnMnOwppbXBvcnQgeyBkYiB9IGZyb20gJy4uLy4uL21haW4nOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZXNwYWNlZDogdHJ1ZSwKICBzdGF0ZTogewogICAgaXRlbXM6IFtdCiAgfSwKICBnZXR0ZXJzOiB7CiAgICB1c2VyOiBmdW5jdGlvbiB1c2VyKHN0YXRlLCBnZXR0ZXJzLCByb290U3RhdGUpIHsKICAgICAgcmV0dXJuIGZ1bmN0aW9uIChpZCkgewogICAgICAgIHZhciB1c2VyID0gZmluZEJ5SWQoc3RhdGUuaXRlbXMsIGlkKTsKICAgICAgICBpZiAoIXVzZXIpIHJldHVybiBudWxsOwogICAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHVzZXIpLCB7fSwgewogICAgICAgICAgZ2V0IHBvc3RzKCkgewogICAgICAgICAgICByZXR1cm4gcm9vdFN0YXRlLnBvc3RzLml0ZW1zLmZpbHRlcihmdW5jdGlvbiAocG9zdCkgewogICAgICAgICAgICAgIHJldHVybiBwb3N0LnVzZXJJZCA9PT0gdXNlci5pZDsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9LAoKICAgICAgICAgIGdldCBwb3N0c0NvdW50KCkgewogICAgICAgICAgICByZXR1cm4gdXNlci5wb3N0c0NvdW50IHx8IDA7CiAgICAgICAgICB9LAoKICAgICAgICAgIGdldCB0aHJlYWRzKCkgewogICAgICAgICAgICByZXR1cm4gcm9vdFN0YXRlLnRocmVhZHMuaXRlbXMuZmlsdGVyKGZ1bmN0aW9uIChwb3N0KSB7CiAgICAgICAgICAgICAgcmV0dXJuIHBvc3QudXNlcklkID09PSB1c2VyLmlkOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0sCgogICAgICAgICAgZ2V0IHRocmVhZHNDb3VudCgpIHsKICAgICAgICAgICAgdmFyIF91c2VyJHRocmVhZHM7CgogICAgICAgICAgICByZXR1cm4gKChfdXNlciR0aHJlYWRzID0gdXNlci50aHJlYWRzKSA9PT0gbnVsbCB8fCBfdXNlciR0aHJlYWRzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdXNlciR0aHJlYWRzLmxlbmd0aCkgfHwgMDsKICAgICAgICAgIH0KCiAgICAgICAgfSk7CiAgICAgIH07CiAgICB9CiAgfSwKICBhY3Rpb25zOiB7CiAgICBjcmVhdGVVc2VyOiBmdW5jdGlvbiBjcmVhdGVVc2VyKF9yZWYsIF9yZWYyKSB7CiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgdmFyIGNvbW1pdCwgaWQsIGVtYWlsLCBuYW1lLCB1c2VybmFtZSwgX3JlZjIkYXZhdGFyLCBhdmF0YXIsIHJlZ2lzdGVyZWRBdCwgdXNlcm5hbWVMb3dlciwgdXNlciwgdXNlclJlZiwgbmV3VXNlcjsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgY29tbWl0ID0gX3JlZi5jb21taXQ7CiAgICAgICAgICAgICAgICBpZCA9IF9yZWYyLmlkLCBlbWFpbCA9IF9yZWYyLmVtYWlsLCBuYW1lID0gX3JlZjIubmFtZSwgdXNlcm5hbWUgPSBfcmVmMi51c2VybmFtZSwgX3JlZjIkYXZhdGFyID0gX3JlZjIuYXZhdGFyLCBhdmF0YXIgPSBfcmVmMiRhdmF0YXIgPT09IHZvaWQgMCA/IG51bGwgOiBfcmVmMiRhdmF0YXI7CiAgICAgICAgICAgICAgICByZWdpc3RlcmVkQXQgPSBzZXJ2ZXJUaW1lc3RhbXAoKTsKICAgICAgICAgICAgICAgIHVzZXJuYW1lTG93ZXIgPSB1c2VybmFtZS50b0xvd2VyQ2FzZSgpOwogICAgICAgICAgICAgICAgZW1haWwgPSBlbWFpbC50b0xvd2VyQ2FzZSgpOwogICAgICAgICAgICAgICAgdXNlciA9IHsKICAgICAgICAgICAgICAgICAgYXZhdGFyOiBhdmF0YXIsCiAgICAgICAgICAgICAgICAgIGVtYWlsOiBlbWFpbCwKICAgICAgICAgICAgICAgICAgbmFtZTogbmFtZSwKICAgICAgICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLAogICAgICAgICAgICAgICAgICB1c2VybmFtZUxvd2VyOiB1c2VybmFtZUxvd2VyLAogICAgICAgICAgICAgICAgICByZWdpc3RlcmVkQXQ6IHJlZ2lzdGVyZWRBdAogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIHVzZXJSZWYgPSBkb2MoZGIsICd1c2VycycsIGlkKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA5OwogICAgICAgICAgICAgICAgcmV0dXJuIHNldERvYyh1c2VyUmVmLCB1c2VyKTsKCiAgICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDExOwogICAgICAgICAgICAgICAgcmV0dXJuIGdldERvYyh1c2VyUmVmKTsKCiAgICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICAgIG5ld1VzZXIgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICAgICAgY29tbWl0KCdzZXRJdGVtJywgewogICAgICAgICAgICAgICAgICByZXNvdXJjZTogJ3VzZXJzJywKICAgICAgICAgICAgICAgICAgaXRlbTogbmV3VXNlcgogICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICByb290OiB0cnVlCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIGRvY1RvUmVzb3VyY2UobmV3VXNlcikpOwoKICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIHVwZGF0ZVVzZXI6IGZ1bmN0aW9uIHVwZGF0ZVVzZXIoX3JlZjMsIHVzZXIpIHsKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7CiAgICAgICAgdmFyIGNvbW1pdCwgdXBkYXRlcywgdXNlclJlZjsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgY29tbWl0ID0gX3JlZjMuY29tbWl0OwogICAgICAgICAgICAgICAgdXBkYXRlcyA9IHsKICAgICAgICAgICAgICAgICAgYXZhdGFyOiB1c2VyLmF2YXRhciB8fCBudWxsLAogICAgICAgICAgICAgICAgICB1c2VybmFtZTogdXNlci51c2VybmFtZSB8fCBudWxsLAogICAgICAgICAgICAgICAgICBuYW1lOiB1c2VyLm5hbWUgfHwgbnVsbCwKICAgICAgICAgICAgICAgICAgYmlvOiB1c2VyLmJpbyB8fCBudWxsLAogICAgICAgICAgICAgICAgICB3ZWJzaXRlOiB1c2VyLndlYnNpdGUgfHwgbnVsbCwKICAgICAgICAgICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwgfHwgbnVsbCwKICAgICAgICAgICAgICAgICAgbG9jYXRpb246IHVzZXIubG9jYXRpb24gfHwgbnVsbAogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIHVzZXJSZWYgPSBkb2MoZGIsICd1c2VycycsIHVzZXIuaWQpOwogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA1OwogICAgICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZURvYyh1c2VyUmVmLCB1cGRhdGVzKTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgY29tbWl0KCdzZXRJdGVtJywgewogICAgICAgICAgICAgICAgICByZXNvdXJjZTogJ3VzZXJzJywKICAgICAgICAgICAgICAgICAgaXRlbTogdXNlcgogICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICByb290OiB0cnVlCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUyKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgZmV0Y2hVc2VyOiBmdW5jdGlvbiBmZXRjaFVzZXIoX3JlZjQsIF9yZWY1KSB7CiAgICAgIHZhciBkaXNwYXRjaCA9IF9yZWY0LmRpc3BhdGNoOwogICAgICB2YXIgaWQgPSBfcmVmNS5pZDsKICAgICAgcmV0dXJuIGRpc3BhdGNoKCdmZXRjaEl0ZW0nLCB7CiAgICAgICAgZW1vamk6ICfwn5mLJywKICAgICAgICByZXNvdXJjZTogJ3VzZXJzJywKICAgICAgICBpZDogaWQKICAgICAgfSwgewogICAgICAgIHJvb3Q6IHRydWUKICAgICAgfSk7CiAgICB9LAogICAgZmV0Y2hVc2VyczogZnVuY3Rpb24gZmV0Y2hVc2VycyhfcmVmNiwgX3JlZjcpIHsKICAgICAgdmFyIGRpc3BhdGNoID0gX3JlZjYuZGlzcGF0Y2g7CiAgICAgIHZhciBpZHMgPSBfcmVmNy5pZHM7CiAgICAgIHJldHVybiBkaXNwYXRjaCgnZmV0Y2hJdGVtcycsIHsKICAgICAgICByZXNvdXJjZTogJ3VzZXJzJywKICAgICAgICBpZHM6IGlkcywKICAgICAgICBlbW9qaTogJ/CfmYsnCiAgICAgIH0sIHsKICAgICAgICByb290OiB0cnVlCiAgICAgIH0pOwogICAgfQogIH0sCiAgbXV0YXRpb25zOiB7CiAgICBhcHBlbmRUaHJlYWRUb1VzZXI6IG1ha2VBcHBlbmRDaGlsZFRvUGFyZW50TXV0YXRpb24oewogICAgICBwYXJlbnQ6ICd1c2VycycsCiAgICAgIGNoaWxkOiAndGhyZWFkcycKICAgIH0pCiAgfQp9Ow=="},{"version":3,"sources":["C:/dev/farming-forum/src/store/modules/users.js"],"names":["doc","getDoc","serverTimestamp","setDoc","updateDoc","docToResource","findById","makeAppendChildToParentMutation","db","namespaced","state","items","getters","user","rootState","id","posts","filter","post","userId","postsCount","threads","threadsCount","length","actions","createUser","commit","email","name","username","avatar","registeredAt","usernameLower","toLowerCase","userRef","newUser","resource","item","root","updateUser","updates","bio","website","location","fetchUser","dispatch","emoji","fetchUsers","ids","mutations","appendThreadToUser","parent","child"],"mappings":"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","sourcesContent":["import { doc, getDoc, serverTimestamp, setDoc, updateDoc } from 'firebase/firestore'\r\nimport { docToResource, findById, makeAppendChildToParentMutation } from '@/helpers'\r\n\r\nimport { db } from '../../main'\r\n\r\nexport default {\r\n  namespaced: true,\r\n  state: {\r\n    items: []\r\n  },\r\n  getters: {\r\n    user: (state, getters, rootState) => {\r\n      return (id) => {\r\n        const user = findById(state.items, id)\r\n        if (!user) return null\r\n        return {\r\n          ...user,\r\n          get posts () {\r\n            return rootState.posts.items.filter(post => post.userId === user.id)\r\n          },\r\n          get postsCount () {\r\n            return user.postsCount || 0\r\n          },\r\n          get threads () {\r\n            return rootState.threads.items.filter(post => post.userId === user.id)\r\n          },\r\n          get threadsCount () {\r\n            return user.threads?.length || 0\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  actions: {\r\n    async createUser({commit}, {id, email, name, username, avatar = null}) {\r\n      const registeredAt = serverTimestamp()\r\n      const usernameLower = username.toLowerCase()\r\n      email = email.toLowerCase()\r\n      const user = {avatar, email, name, username, usernameLower, registeredAt }\r\n      const userRef = doc(db, 'users', id)\r\n      await setDoc(userRef, user)\r\n      const newUser = await getDoc(userRef)\r\n      commit('setItem', { resource: 'users', item: newUser }, { root: true })\r\n      return docToResource(newUser)\r\n    },\r\n    async updateUser ({ commit }, user) {\r\n      const updates = {\r\n        avatar: user.avatar || null,\r\n        username: user.username || null,\r\n        name: user.name || null,\r\n        bio: user.bio || null,\r\n        website: user.website || null,\r\n        email: user.email || null,\r\n        location: user.location || null\r\n      }\r\n      const userRef = doc(db, 'users', user.id)\r\n      await updateDoc(userRef, updates)\r\n      commit('setItem', { resource: 'users', item: user }, { root: true })\r\n    },\r\n    fetchUser: ({ dispatch }, { id }) => dispatch('fetchItem', { emoji: '🙋', resource: 'users', id }, { root: true }),\r\n    fetchUsers: ({ dispatch }, { ids }) => dispatch('fetchItems', { resource: 'users', ids, emoji: '🙋' }, { root: true }),\r\n  },\r\n  mutations: {\r\n    appendThreadToUser: makeAppendChildToParentMutation({parent: 'users', child: 'threads'})\r\n  }\r\n}"]}]}