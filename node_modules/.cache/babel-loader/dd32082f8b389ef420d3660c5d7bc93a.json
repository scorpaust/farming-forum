{"remainingRequest":"C:\\dev\\farming-forum\\node_modules\\babel-loader\\lib\\index.js!C:\\dev\\farming-forum\\node_modules\\eslint-loader\\index.js??ref--14-0!C:\\dev\\farming-forum\\src\\store\\modules\\users.js","dependencies":[{"path":"C:\\dev\\farming-forum\\src\\store\\modules\\users.js","mtime":1640088614034},{"path":"C:\\dev\\farming-forum\\babel.config.js","mtime":1638558199793},{"path":"C:\\dev\\farming-forum\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\dev\\farming-forum\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\dev\\farming-forum\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkM6XFxkZXZcXGZhcm1pbmctZm9ydW1cXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lXFxoZWxwZXJzXFxlc21cXGFzeW5jVG9HZW5lcmF0b3IuanMiOwppbXBvcnQgX29iamVjdFNwcmVhZCBmcm9tICJDOlxcZGV2XFxmYXJtaW5nLWZvcnVtXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZVxcaGVscGVyc1xcZXNtXFxvYmplY3RTcHJlYWQyLmpzIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCB7IGRvYywgZ2V0RG9jLCBzZXJ2ZXJUaW1lc3RhbXAsIHNldERvYywgdXBkYXRlRG9jIH0gZnJvbSAnZmlyZWJhc2UvZmlyZXN0b3JlJzsKaW1wb3J0IHsgZG9jVG9SZXNvdXJjZSwgZmluZEJ5SWQsIG1ha2VBcHBlbmRDaGlsZFRvUGFyZW50TXV0YXRpb24sIG1ha2VGZXRjaEl0ZW1BY3Rpb24sIG1ha2VGZXRjaEl0ZW1zQWN0aW9uIH0gZnJvbSAnQC9oZWxwZXJzJzsKaW1wb3J0IHsgZGIgfSBmcm9tICcuLi8uLi9tYWluJzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWVzcGFjZWQ6IHRydWUsCiAgc3RhdGU6IHsKICAgIGl0ZW1zOiBbXQogIH0sCiAgZ2V0dGVyczogewogICAgdXNlcjogZnVuY3Rpb24gdXNlcihzdGF0ZSwgZ2V0dGVycywgcm9vdFN0YXRlKSB7CiAgICAgIHJldHVybiBmdW5jdGlvbiAoaWQpIHsKICAgICAgICB2YXIgdXNlciA9IGZpbmRCeUlkKHN0YXRlLml0ZW1zLCBpZCk7CiAgICAgICAgaWYgKCF1c2VyKSByZXR1cm4gbnVsbDsKICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCB1c2VyKSwge30sIHsKICAgICAgICAgIGdldCBwb3N0cygpIHsKICAgICAgICAgICAgcmV0dXJuIHJvb3RTdGF0ZS5wb3N0cy5pdGVtcy5maWx0ZXIoZnVuY3Rpb24gKHBvc3QpIHsKICAgICAgICAgICAgICByZXR1cm4gcG9zdC51c2VySWQgPT09IHVzZXIuaWQ7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSwKCiAgICAgICAgICBnZXQgcG9zdHNDb3VudCgpIHsKICAgICAgICAgICAgcmV0dXJuIHVzZXIucG9zdHNDb3VudCB8fCAwOwogICAgICAgICAgfSwKCiAgICAgICAgICBnZXQgdGhyZWFkcygpIHsKICAgICAgICAgICAgcmV0dXJuIHJvb3RTdGF0ZS50aHJlYWRzLml0ZW1zLmZpbHRlcihmdW5jdGlvbiAocG9zdCkgewogICAgICAgICAgICAgIHJldHVybiBwb3N0LnVzZXJJZCA9PT0gdXNlci5pZDsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9LAoKICAgICAgICAgIGdldCB0aHJlYWRzQ291bnQoKSB7CiAgICAgICAgICAgIHZhciBfdXNlciR0aHJlYWRzOwoKICAgICAgICAgICAgcmV0dXJuICgoX3VzZXIkdGhyZWFkcyA9IHVzZXIudGhyZWFkcykgPT09IG51bGwgfHwgX3VzZXIkdGhyZWFkcyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3VzZXIkdGhyZWFkcy5sZW5ndGgpIHx8IDA7CiAgICAgICAgICB9CgogICAgICAgIH0pOwogICAgICB9OwogICAgfQogIH0sCiAgYWN0aW9uczogewogICAgY3JlYXRlVXNlcjogZnVuY3Rpb24gY3JlYXRlVXNlcihfcmVmLCBfcmVmMikgewogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciBjb21taXQsIGlkLCBlbWFpbCwgbmFtZSwgdXNlcm5hbWUsIF9yZWYyJGF2YXRhciwgYXZhdGFyLCByZWdpc3RlcmVkQXQsIHVzZXJuYW1lTG93ZXIsIHVzZXIsIHVzZXJSZWYsIG5ld1VzZXI7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGNvbW1pdCA9IF9yZWYuY29tbWl0OwogICAgICAgICAgICAgICAgaWQgPSBfcmVmMi5pZCwgZW1haWwgPSBfcmVmMi5lbWFpbCwgbmFtZSA9IF9yZWYyLm5hbWUsIHVzZXJuYW1lID0gX3JlZjIudXNlcm5hbWUsIF9yZWYyJGF2YXRhciA9IF9yZWYyLmF2YXRhciwgYXZhdGFyID0gX3JlZjIkYXZhdGFyID09PSB2b2lkIDAgPyBudWxsIDogX3JlZjIkYXZhdGFyOwogICAgICAgICAgICAgICAgcmVnaXN0ZXJlZEF0ID0gc2VydmVyVGltZXN0YW1wKCk7CiAgICAgICAgICAgICAgICB1c2VybmFtZUxvd2VyID0gdXNlcm5hbWUudG9Mb3dlckNhc2UoKTsKICAgICAgICAgICAgICAgIGVtYWlsID0gZW1haWwudG9Mb3dlckNhc2UoKTsKICAgICAgICAgICAgICAgIHVzZXIgPSB7CiAgICAgICAgICAgICAgICAgIGF2YXRhcjogYXZhdGFyLAogICAgICAgICAgICAgICAgICBlbWFpbDogZW1haWwsCiAgICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUsCiAgICAgICAgICAgICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZSwKICAgICAgICAgICAgICAgICAgdXNlcm5hbWVMb3dlcjogdXNlcm5hbWVMb3dlciwKICAgICAgICAgICAgICAgICAgcmVnaXN0ZXJlZEF0OiByZWdpc3RlcmVkQXQKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB1c2VyUmVmID0gZG9jKGRiLCAndXNlcnMnLCBpZCk7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gOTsKICAgICAgICAgICAgICAgIHJldHVybiBzZXREb2ModXNlclJlZiwgdXNlcik7CgogICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMTsKICAgICAgICAgICAgICAgIHJldHVybiBnZXREb2ModXNlclJlZik7CgogICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgICBuZXdVc2VyID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICAgIGNvbW1pdCgnc2V0SXRlbScsIHsKICAgICAgICAgICAgICAgICAgcmVzb3VyY2U6ICd1c2VycycsCiAgICAgICAgICAgICAgICAgIGl0ZW06IG5ld1VzZXIKICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgcm9vdDogdHJ1ZQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBkb2NUb1Jlc291cmNlKG5ld1VzZXIpKTsKCiAgICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICB1cGRhdGVVc2VyOiBmdW5jdGlvbiB1cGRhdGVVc2VyKF9yZWYzLCB1c2VyKSB7CiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgICAgIHZhciBjb21taXQsIHVwZGF0ZXMsIHVzZXJSZWY7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGNvbW1pdCA9IF9yZWYzLmNvbW1pdDsKICAgICAgICAgICAgICAgIHVwZGF0ZXMgPSB7CiAgICAgICAgICAgICAgICAgIGF2YXRhcjogdXNlci5hdmF0YXIgfHwgbnVsbCwKICAgICAgICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXIudXNlcm5hbWUgfHwgbnVsbCwKICAgICAgICAgICAgICAgICAgbmFtZTogdXNlci5uYW1lIHx8IG51bGwsCiAgICAgICAgICAgICAgICAgIGJpbzogdXNlci5iaW8gfHwgbnVsbCwKICAgICAgICAgICAgICAgICAgd2Vic2l0ZTogdXNlci53ZWJzaXRlIHx8IG51bGwsCiAgICAgICAgICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsIHx8IG51bGwsCiAgICAgICAgICAgICAgICAgIGxvY2F0aW9uOiB1c2VyLmxvY2F0aW9uIHx8IG51bGwKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB1c2VyUmVmID0gZG9jKGRiLCAndXNlcnMnLCB1c2VyLmlkKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNTsKICAgICAgICAgICAgICAgIHJldHVybiB1cGRhdGVEb2ModXNlclJlZiwgdXBkYXRlcyk7CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgIGNvbW1pdCgnc2V0SXRlbScsIHsKICAgICAgICAgICAgICAgICAgcmVzb3VyY2U6ICd1c2VycycsCiAgICAgICAgICAgICAgICAgIGl0ZW06IHVzZXIKICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgcm9vdDogdHJ1ZQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMik7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIGZldGNoVXNlcjogbWFrZUZldGNoSXRlbUFjdGlvbih7CiAgICAgIGVtb2ppOiAn8J+ZiycsCiAgICAgIHJlc291cmNlOiAndXNlcnMnCiAgICB9KSwKICAgIGZldGNoVXNlcnM6IG1ha2VGZXRjaEl0ZW1zQWN0aW9uKHsKICAgICAgcmVzb3VyY2U6ICd1c2VycycsCiAgICAgIGVtb2ppOiAn8J+ZiycKICAgIH0pCiAgfSwKICBtdXRhdGlvbnM6IHsKICAgIGFwcGVuZFRocmVhZFRvVXNlcjogbWFrZUFwcGVuZENoaWxkVG9QYXJlbnRNdXRhdGlvbih7CiAgICAgIHBhcmVudDogJ3VzZXJzJywKICAgICAgY2hpbGQ6ICd0aHJlYWRzJwogICAgfSkKICB9Cn07"},{"version":3,"sources":["C:/dev/farming-forum/src/store/modules/users.js"],"names":["doc","getDoc","serverTimestamp","setDoc","updateDoc","docToResource","findById","makeAppendChildToParentMutation","makeFetchItemAction","makeFetchItemsAction","db","namespaced","state","items","getters","user","rootState","id","posts","filter","post","userId","postsCount","threads","threadsCount","length","actions","createUser","commit","email","name","username","avatar","registeredAt","usernameLower","toLowerCase","userRef","newUser","resource","item","root","updateUser","updates","bio","website","location","fetchUser","emoji","fetchUsers","mutations","appendThreadToUser","parent","child"],"mappings":"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","sourcesContent":["import { doc, getDoc, serverTimestamp, setDoc, updateDoc } from 'firebase/firestore'\r\nimport { docToResource, findById, makeAppendChildToParentMutation, makeFetchItemAction, makeFetchItemsAction } from '@/helpers'\r\n\r\nimport { db } from '../../main'\r\n\r\nexport default {\r\n  namespaced: true,\r\n  state: {\r\n    items: []\r\n  },\r\n  getters: {\r\n    user: (state, getters, rootState) => {\r\n      return (id) => {\r\n        const user = findById(state.items, id)\r\n        if (!user) return null\r\n        return {\r\n          ...user,\r\n          get posts () {\r\n            return rootState.posts.items.filter(post => post.userId === user.id)\r\n          },\r\n          get postsCount () {\r\n            return user.postsCount || 0\r\n          },\r\n          get threads () {\r\n            return rootState.threads.items.filter(post => post.userId === user.id)\r\n          },\r\n          get threadsCount () {\r\n            return user.threads?.length || 0\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  actions: {\r\n    async createUser({commit}, {id, email, name, username, avatar = null}) {\r\n      const registeredAt = serverTimestamp()\r\n      const usernameLower = username.toLowerCase()\r\n      email = email.toLowerCase()\r\n      const user = {avatar, email, name, username, usernameLower, registeredAt }\r\n      const userRef = doc(db, 'users', id)\r\n      await setDoc(userRef, user)\r\n      const newUser = await getDoc(userRef)\r\n      commit('setItem', { resource: 'users', item: newUser }, { root: true })\r\n      return docToResource(newUser)\r\n    },\r\n    async updateUser ({ commit }, user) {\r\n      const updates = {\r\n        avatar: user.avatar || null,\r\n        username: user.username || null,\r\n        name: user.name || null,\r\n        bio: user.bio || null,\r\n        website: user.website || null,\r\n        email: user.email || null,\r\n        location: user.location || null\r\n      }\r\n      const userRef = doc(db, 'users', user.id)\r\n      await updateDoc(userRef, updates)\r\n      commit('setItem', { resource: 'users', item: user }, { root: true })\r\n    },\r\n    fetchUser: makeFetchItemAction({ emoji: '🙋', resource: 'users' }),\r\n    fetchUsers: makeFetchItemsAction({ resource: 'users', emoji: '🙋' })\r\n  },\r\n  mutations: {\r\n    appendThreadToUser: makeAppendChildToParentMutation({parent: 'users', child: 'threads'})\r\n  }\r\n}"]}]}