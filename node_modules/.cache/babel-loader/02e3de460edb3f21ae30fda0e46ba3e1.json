{"remainingRequest":"C:\\dev\\farming-forum\\node_modules\\babel-loader\\lib\\index.js!C:\\dev\\farming-forum\\node_modules\\eslint-loader\\index.js??ref--14-0!C:\\dev\\farming-forum\\src\\store\\modules\\auth.js","dependencies":[{"path":"C:\\dev\\farming-forum\\src\\store\\modules\\auth.js","mtime":1639942763204},{"path":"C:\\dev\\farming-forum\\babel.config.js","mtime":1638558199793},{"path":"C:\\dev\\farming-forum\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\dev\\farming-forum\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\dev\\farming-forum\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkM6XFxkZXZcXGZhcm1pbmctZm9ydW1cXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lXFxoZWxwZXJzXFxlc21cXGFzeW5jVG9HZW5lcmF0b3IuanMiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCB7IEdvb2dsZUF1dGhQcm92aWRlciwgY3JlYXRlVXNlcldpdGhFbWFpbEFuZFBhc3N3b3JkLCBnZXRBdXRoLCBzaWduSW5XaXRoRW1haWxBbmRQYXNzd29yZCBhcyBfc2lnbkluV2l0aEVtYWlsQW5kUGFzc3dvcmQsIHNpZ25JbldpdGhQb3B1cCB9IGZyb20gImZpcmViYXNlL2F1dGgiOwppbXBvcnQgeyBjb2xsZWN0aW9uLCBkb2MsIGdldERvYywgZ2V0RG9jcywgcXVlcnksIHdoZXJlIH0gZnJvbSAiZmlyZWJhc2UvZmlyZXN0b3JlIjsKaW1wb3J0IHsgZGIgfSBmcm9tICcuLi8uLi9tYWluJzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWVzcGFjZWQ6IHRydWUsCiAgc3RhdGU6IHsKICAgIGF1dGhJZDogbnVsbCwKICAgIGF1dGhVc2VyVW5zdWJzY3JpYmU6IG51bGwsCiAgICBhdXRoT2JzZXJ2ZXJVbnN1YnNjcmliZTogbnVsbAogIH0sCiAgZ2V0dGVyczogewogICAgYXV0aFVzZXI6IGZ1bmN0aW9uIGF1dGhVc2VyKHN0YXRlLCBnZXR0ZXJzLCByb290U3RhdGUsIHJvb3RHZXR0ZXJzKSB7CiAgICAgIHJldHVybiByb290R2V0dGVyc1sndXNlcnMvdXNlciddKHN0YXRlLmF1dGhJZCk7CiAgICB9CiAgfSwKICBhY3Rpb25zOiB7CiAgICBpbml0QXV0aGVudGljYXRpb246IGZ1bmN0aW9uIGluaXRBdXRoZW50aWNhdGlvbihfcmVmKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB2YXIgc3RhdGUgPSBfcmVmLnN0YXRlLAogICAgICAgICAgZGlzcGF0Y2ggPSBfcmVmLmRpc3BhdGNoLAogICAgICAgICAgY29tbWl0ID0gX3JlZi5jb21taXQ7CiAgICAgIGlmIChzdGF0ZS5hdXRoT2JzZXJ2ZXJVbnN1YnNjcmliZSkgc3RhdGUuYXV0aE9ic2VydmVyVW5zdWJzY3JpYmUoKTsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICB2YXIgdW5zdWJzY3JpYmUgPSBnZXRBdXRoKCkub25BdXRoU3RhdGVDaGFuZ2VkKCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIF9yZWYyID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKHVzZXIpIHsKICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIF90aGlzLmRpc3BhdGNoKCdhdXRoL3Vuc3Vic2NyaWJlQXV0aFVzZXJTbmFwc2hvdCcpOwoKICAgICAgICAgICAgICAgICAgICBpZiAoIXVzZXIpIHsKICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA3OwogICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNDsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuZGlzcGF0Y2goJ2F1dGgvZmV0Y2hBdXRoVXNlcicpOwoKICAgICAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgICAgIHJlcyh1c2VyKTsKICAgICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gODsKICAgICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICAgICAgICByZXMobnVsbCk7CgogICAgICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIF9jYWxsZWUpOwogICAgICAgICAgfSkpOwoKICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoX3gpIHsKICAgICAgICAgICAgcmV0dXJuIF9yZWYyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICB9OwogICAgICAgIH0oKSk7CiAgICAgICAgY29tbWl0KCJzZXRBdXRoT2JzZXJ2ZXJVbnN1YnNjcmliZSIsIHVuc3Vic2NyaWJlKTsKICAgICAgfSk7CiAgICB9LAogICAgcmVnaXN0ZXJVc2VyV2l0aEVtYWlsQW5kUGFzc3dvcmQ6IGZ1bmN0aW9uIHJlZ2lzdGVyVXNlcldpdGhFbWFpbEFuZFBhc3N3b3JkKF9yZWYzLCBfcmVmNCkgewogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMigpIHsKICAgICAgICB2YXIgZGlzcGF0Y2gsIF9yZWY0JGF2YXRhciwgYXZhdGFyLCBlbWFpbCwgbmFtZSwgdXNlcm5hbWUsIHBhc3N3b3JkLCBhdXRoLCByZXN1bHQ7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBkaXNwYXRjaCA9IF9yZWYzLmRpc3BhdGNoOwogICAgICAgICAgICAgICAgX3JlZjQkYXZhdGFyID0gX3JlZjQuYXZhdGFyLCBhdmF0YXIgPSBfcmVmNCRhdmF0YXIgPT09IHZvaWQgMCA/IG51bGwgOiBfcmVmNCRhdmF0YXIsIGVtYWlsID0gX3JlZjQuZW1haWwsIG5hbWUgPSBfcmVmNC5uYW1lLCB1c2VybmFtZSA9IF9yZWY0LnVzZXJuYW1lLCBwYXNzd29yZCA9IF9yZWY0LnBhc3N3b3JkOwogICAgICAgICAgICAgICAgYXV0aCA9IGdldEF1dGgoKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNTsKICAgICAgICAgICAgICAgIHJldHVybiBjcmVhdGVVc2VyV2l0aEVtYWlsQW5kUGFzc3dvcmQoYXV0aCwgZW1haWwsIHBhc3N3b3JkKTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgcmVzdWx0ID0gX2NvbnRleHQyLnNlbnQ7CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDg7CiAgICAgICAgICAgICAgICByZXR1cm4gZGlzcGF0Y2goJ3VzZXJzL2NyZWF0ZVVzZXInLCB7CiAgICAgICAgICAgICAgICAgIGlkOiByZXN1bHQudXNlci51aWQsCiAgICAgICAgICAgICAgICAgIGVtYWlsOiBlbWFpbCwKICAgICAgICAgICAgICAgICAgbmFtZTogbmFtZSwKICAgICAgICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLAogICAgICAgICAgICAgICAgICBhdmF0YXI6IGF2YXRhcgogICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICByb290OiB0cnVlCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUyKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgc2lnbkluV2l0aEVtYWlsQW5kUGFzc3dvcmQ6IGZ1bmN0aW9uIHNpZ25JbldpdGhFbWFpbEFuZFBhc3N3b3JkKGNvbnRleHQsIF9yZWY1KSB7CiAgICAgIHZhciBlbWFpbCA9IF9yZWY1LmVtYWlsLAogICAgICAgICAgcGFzc3dvcmQgPSBfcmVmNS5wYXNzd29yZDsKICAgICAgdmFyIGF1dGggPSBnZXRBdXRoKCk7CiAgICAgIHJldHVybiBfc2lnbkluV2l0aEVtYWlsQW5kUGFzc3dvcmQoYXV0aCwgZW1haWwsIHBhc3N3b3JkKTsKICAgIH0sCiAgICBzaWduSW5XaXRoR29vZ2xlOiBmdW5jdGlvbiBzaWduSW5XaXRoR29vZ2xlKF9yZWY2KSB7CiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKCkgewogICAgICAgIHZhciBkaXNwYXRjaCwgY29tbWl0LCBwcm92aWRlciwgYXV0aCwgcmVzcG9uc2UsIHVzZXIsIHVzZXJSZWY7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzJChfY29udGV4dDMpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGRpc3BhdGNoID0gX3JlZjYuZGlzcGF0Y2gsIGNvbW1pdCA9IF9yZWY2LmNvbW1pdDsKICAgICAgICAgICAgICAgIHByb3ZpZGVyID0gbmV3IEdvb2dsZUF1dGhQcm92aWRlcigpOwogICAgICAgICAgICAgICAgYXV0aCA9IGdldEF1dGgoKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gNTsKICAgICAgICAgICAgICAgIHJldHVybiBzaWduSW5XaXRoUG9wdXAoYXV0aCwgcHJvdmlkZXIpOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICByZXNwb25zZSA9IF9jb250ZXh0My5zZW50OwogICAgICAgICAgICAgICAgdXNlciA9IHJlc3BvbnNlLnVzZXI7CiAgICAgICAgICAgICAgICB1c2VyUmVmID0gZG9jKGRiLCAndXNlcnMnLCB1c2VyLnVpZCk7CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDEwOwogICAgICAgICAgICAgICAgcmV0dXJuIGdldERvYyh1c2VyUmVmKS50aGVuKGZ1bmN0aW9uICh1c2VyRG9jKSB7CiAgICAgICAgICAgICAgICAgIGlmICghdXNlckRvYy5leGlzdHMpIHJldHVybiBkaXNwYXRjaCgndXNlcnMvY3JlYXRlVXNlcicsIHsKICAgICAgICAgICAgICAgICAgICBpZDogdXNlci51aWQsCiAgICAgICAgICAgICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwsCiAgICAgICAgICAgICAgICAgICAgbmFtZTogdXNlci5kaXNwbGF5TmFtZSwKICAgICAgICAgICAgICAgICAgICB1c2VybmFtZTogdXNlci5lbWFpbCwKICAgICAgICAgICAgICAgICAgICBhdmF0YXI6IHVzZXIucGhvdG9VUkwKICAgICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICAgIHJvb3Q6IHRydWUKICAgICAgICAgICAgICAgICAgfSk7ZWxzZSBjb21taXQoJ3NldEF1dGhJZCcsIHVzZXIudWlkKTsKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUzKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgc2lnbk91dDogZnVuY3Rpb24gc2lnbk91dChfcmVmNykgewogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNCgpIHsKICAgICAgICB2YXIgY29tbWl0OwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBjb21taXQgPSBfcmVmNy5jb21taXQ7CiAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDM7CiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0QXV0aCgpLnNpZ25PdXQoKTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgY29tbWl0KCdzZXRBdXRoSWQnLCBudWxsKTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU0KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgZmV0Y2hBdXRoVXNlcjogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2ZldGNoQXV0aFVzZXIgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1KF9yZWY4KSB7CiAgICAgICAgdmFyIF9nZXRBdXRoJGN1cnJlbnRVc2VyOwoKICAgICAgICB2YXIgZGlzcGF0Y2gsIHN0YXRlLCBjb21taXQsIHVzZXJJZDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTUkKF9jb250ZXh0NSkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDUucHJldiA9IF9jb250ZXh0NS5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgZGlzcGF0Y2ggPSBfcmVmOC5kaXNwYXRjaCwgc3RhdGUgPSBfcmVmOC5zdGF0ZSwgY29tbWl0ID0gX3JlZjguY29tbWl0OwogICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIChfZ2V0QXV0aCRjdXJyZW50VXNlciA9IGdldEF1dGgoKS5jdXJyZW50VXNlcikgPT09IG51bGwgfHwgX2dldEF1dGgkY3VycmVudFVzZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9nZXRBdXRoJGN1cnJlbnRVc2VyLnVpZDsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgdXNlcklkID0gX2NvbnRleHQ1LnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKHVzZXJJZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDY7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSA4OwogICAgICAgICAgICAgICAgcmV0dXJuIGRpc3BhdGNoKCdmZXRjaEl0ZW0nLCB7CiAgICAgICAgICAgICAgICAgIGVtb2ppOiAn8J+ZiycsCiAgICAgICAgICAgICAgICAgIHJlc291cmNlOiAndXNlcnMnLAogICAgICAgICAgICAgICAgICBpZDogdXNlcklkLAogICAgICAgICAgICAgICAgICBoYW5kbGVVbnN1YnNjcmliZTogZnVuY3Rpb24gaGFuZGxlVW5zdWJzY3JpYmUodW5zdWJzY3JpYmUpIHsKICAgICAgICAgICAgICAgICAgICBjb21taXQoJ3NldEF1dGhVc2VyVW5zdWJzY3JpYmUnLCB1bnN1YnNjcmliZSk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgcm9vdDogdHJ1ZQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgIGNvbW1pdCgnc2V0QXV0aElkJywgdXNlcklkKTsKCiAgICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU1KTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gZmV0Y2hBdXRoVXNlcihfeDIpIHsKICAgICAgICByZXR1cm4gX2ZldGNoQXV0aFVzZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGZldGNoQXV0aFVzZXI7CiAgICB9KCksCiAgICBmZXRjaEF1dGhVc2Vyc1Bvc3RzOiBmdW5jdGlvbiBmZXRjaEF1dGhVc2Vyc1Bvc3RzKF9yZWY5KSB7CiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU2KCkgewogICAgICAgIHZhciBjb21taXQsIHN0YXRlLCBwb3N0c1JlZiwgcG9zdHM7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU2JChfY29udGV4dDYpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ2LnByZXYgPSBfY29udGV4dDYubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGNvbW1pdCA9IF9yZWY5LmNvbW1pdCwgc3RhdGUgPSBfcmVmOS5zdGF0ZTsKICAgICAgICAgICAgICAgIHBvc3RzUmVmID0gY29sbGVjdGlvbihkYiwgInBvc3RzIik7CiAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0RG9jcyhxdWVyeShwb3N0c1JlZiwgd2hlcmUoInVzZXJJZCIsICI9PSIsIHN0YXRlLmF1dGhJZCkpKTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgcG9zdHMgPSBfY29udGV4dDYuc2VudDsKICAgICAgICAgICAgICAgIHBvc3RzLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgY29tbWl0KCdzZXRJdGVtJywgewogICAgICAgICAgICAgICAgICAgIHJlc291cmNlOiAncG9zdHMnLAogICAgICAgICAgICAgICAgICAgIGl0ZW06IGl0ZW0KICAgICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICAgIHJvb3Q6IHRydWUKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU2KTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgdW5zdWJzY3JpYmVBdXRoVXNlclNuYXBzaG90OiBmdW5jdGlvbiB1bnN1YnNjcmliZUF1dGhVc2VyU25hcHNob3QoX3JlZjEwKSB7CiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU3KCkgewogICAgICAgIHZhciBzdGF0ZSwgY29tbWl0OwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNyQoX2NvbnRleHQ3KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Ny5wcmV2ID0gX2NvbnRleHQ3Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBzdGF0ZSA9IF9yZWYxMC5zdGF0ZSwgY29tbWl0ID0gX3JlZjEwLmNvbW1pdDsKCiAgICAgICAgICAgICAgICBpZiAoc3RhdGUuYXV0aFVzZXJVbnN1YnNjcmliZSkgewogICAgICAgICAgICAgICAgICBzdGF0ZS5hdXRoVXNlclVuc3Vic2NyaWJlKCk7CiAgICAgICAgICAgICAgICAgIGNvbW1pdCgnc2V0QXV0aFVzZXJVbnN1YnNjcmliZScsIG51bGwpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTcpOwogICAgICB9KSkoKTsKICAgIH0KICB9LAogIG11dGF0aW9uczogewogICAgc2V0QXV0aElkOiBmdW5jdGlvbiBzZXRBdXRoSWQoc3RhdGUsIGlkKSB7CiAgICAgIHN0YXRlLmF1dGhJZCA9IGlkOwogICAgfSwKICAgIHNldEF1dGhVc2VyVW5zdWJzY3JpYmU6IGZ1bmN0aW9uIHNldEF1dGhVc2VyVW5zdWJzY3JpYmUoc3RhdGUsIHVuc3Vic2NyaWJlKSB7CiAgICAgIHN0YXRlLmF1dGhVc2VyVW5zdWJzY3JpYmUgPSB1bnN1YnNjcmliZTsKICAgIH0sCiAgICBzZXRBdXRoT2JzZXJ2ZXJVbnN1YnNjcmliZTogZnVuY3Rpb24gc2V0QXV0aE9ic2VydmVyVW5zdWJzY3JpYmUoc3RhdGUsIHVuc3Vic2NyaWJlKSB7CiAgICAgIHN0YXRlLmF1dGhPYnNlcnZlclVuc3Vic2NyaWJlID0gdW5zdWJzY3JpYmU7CiAgICB9CiAgfQp9Ow=="},{"version":3,"sources":["C:/dev/farming-forum/src/store/modules/auth.js"],"names":["GoogleAuthProvider","createUserWithEmailAndPassword","getAuth","signInWithEmailAndPassword","signInWithPopup","collection","doc","getDoc","getDocs","query","where","db","namespaced","state","authId","authUserUnsubscribe","authObserverUnsubscribe","getters","authUser","rootState","rootGetters","actions","initAuthentication","dispatch","commit","Promise","res","unsubscribe","onAuthStateChanged","user","registerUserWithEmailAndPassword","avatar","email","name","username","password","auth","result","id","uid","root","context","signInWithGoogle","provider","response","userRef","then","userDoc","exists","displayName","photoURL","signOut","fetchAuthUser","currentUser","userId","emoji","resource","handleUnsubscribe","fetchAuthUsersPosts","postsRef","posts","forEach","item","unsubscribeAuthUserSnapshot","mutations","setAuthId","setAuthUserUnsubscribe","setAuthObserverUnsubscribe"],"mappings":"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","sourcesContent":["import { GoogleAuthProvider, createUserWithEmailAndPassword, getAuth, signInWithEmailAndPassword, signInWithPopup } from \"firebase/auth\"\r\nimport {collection, doc, getDoc, getDocs, query, where} from \"firebase/firestore\"\r\n\r\nimport { db } from '../../main'\r\n\r\nexport default {\r\n  namespaced: true,\r\n  state: {\r\n    authId: null,\r\n    authUserUnsubscribe: null,\r\n    authObserverUnsubscribe: null\r\n  },\r\n  getters: {\r\n    authUser: (state, getters, rootState, rootGetters) => {\r\n      return rootGetters['users/user'](state.authId)\r\n    },\r\n  },\r\n  actions: {\r\n    initAuthentication({state, dispatch, commit}) {\r\n      if (state.authObserverUnsubscribe) state.authObserverUnsubscribe()\r\n      return new Promise((res) => {\r\n        const unsubscribe = getAuth().onAuthStateChanged(async (user) => {\r\n          this.dispatch('auth/unsubscribeAuthUserSnapshot')\r\n          if (user) {\r\n            await this.dispatch('auth/fetchAuthUser')\r\n            res(user)\r\n          } else {\r\n            res(null)\r\n          }\r\n        })\r\n        commit(\"setAuthObserverUnsubscribe\", unsubscribe)\r\n      })\r\n    },\r\n\r\n    async registerUserWithEmailAndPassword({ dispatch }, {avatar = null, email, name, username, password }) {\r\n      const auth = getAuth();\r\n      const result = await createUserWithEmailAndPassword(\r\n        auth,\r\n        email,\r\n        password\r\n      )\r\n      await dispatch('users/createUser', { id: result.user.uid, email, name, username, avatar }, {root: true} )\r\n    },\r\n    signInWithEmailAndPassword(context, {email, password}) {\r\n      const auth = getAuth()\r\n      return signInWithEmailAndPassword(auth, email, password)\r\n    },\r\n    async signInWithGoogle({dispatch, commit}) {\r\n      const provider = new GoogleAuthProvider();\r\n      const auth = getAuth();\r\n      const response = await signInWithPopup(auth, provider)\r\n      const user = response.user;\r\n      const userRef = doc(db, 'users', user.uid)\r\n      await getDoc(userRef).then((userDoc) => {\r\n        if (!userDoc.exists)\r\n          return dispatch('users/createUser', {id: user.uid, email: user.email, name: user.displayName, username: user.email, avatar: user.photoURL}, {root: true} )\r\n        else \r\n          commit('setAuthId', user.uid)\r\n      })\r\n    },\r\n    async signOut({commit}) {\r\n      await getAuth().signOut()\r\n      commit('setAuthId', null)\r\n    },\r\n\r\n    fetchAuthUser: async ({ dispatch, state, commit }) => {\r\n      const userId = await getAuth().currentUser?.uid\r\n      if (!userId) return\r\n      await dispatch('fetchItem', { emoji:'🙋', resource: 'users', id: userId, handleUnsubscribe: (unsubscribe) => {\r\n        commit('setAuthUserUnsubscribe', unsubscribe)\r\n      }}, {root: true} )\r\n      commit('setAuthId', userId)\r\n    },\r\n    async fetchAuthUsersPosts ({ commit, state }) {\r\n      const postsRef = collection(db, \"posts\")\r\n      const posts = await getDocs(query(postsRef, where(\"userId\", \"==\", state.authId)))\r\n      posts.forEach(item => {\r\n        commit('setItem', { resource: 'posts', item }, {root: true})\r\n      })\r\n    },\r\n    async unsubscribeAuthUserSnapshot ({ state, commit }) {\r\n      if (state.authUserUnsubscribe) {\r\n        state.authUserUnsubscribe()\r\n        commit('setAuthUserUnsubscribe', null)        \r\n      }\r\n    }\r\n  },\r\n  mutations: {\r\n    setAuthId(state, id) {\r\n      state.authId = id\r\n    },\r\n    setAuthUserUnsubscribe (state, unsubscribe) {\r\n      state.authUserUnsubscribe = unsubscribe\r\n    },\r\n    setAuthObserverUnsubscribe (state, unsubscribe) {\r\n      state.authObserverUnsubscribe = unsubscribe\r\n    },\r\n  }\r\n}"]}]}